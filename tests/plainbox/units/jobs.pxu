id: snapcraft/normal/no-yaml
plugin: shell
estimated_duration: 0.1
command:
    set -x
    OUTPUT=$(snapcraft pull)
    test $? = 1 || exit 1
    echo $OUTPUT | grep "Could not find snapcraft\.yaml\."

id: snapcraft/normal/local-source
plugin: shell
estimated_duration: 0.3
command:
    set -ex
    cp -rT $PLAINBOX_PROVIDER_DATA/local-source .
    snapcraft build
    test -e stamp-all
    test "$(readlink parts/make-project/build)" = "$(pwd)"
    snapcraft stage
    test -e stamp-install

id: snapcraft/normal/simple-make
plugin: shell
estimated_duration: 0.3
command:
    set -ex
    cp -rT $PLAINBOX_PROVIDER_DATA/simple-make .
    snapcraft snap
    test "$(./snap/bin/test)" = "Hello world"

id: snapcraft/normal/conflicts
plugin: shell
estimated_duration: 0.3
command:
    set -x
    cp -rT $PLAINBOX_PROVIDER_DATA/conflicts .
    OUTPUT=$(snapcraft stage)
    test $? = 1 || exit 1
    echo $OUTPUT | grep "Error: parts p1 and p2 have the following files in common: bin/test" # squished output by bash
